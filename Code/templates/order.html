<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
      <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}"> 
   </head>
   <body>

      <div class="topnav">
         <a class="active" href="/">Home</a>
         <a href="/signup">Sign up</a>
         <a href="/signin">Sign in</a>
         <a href="/chat">Chat</a>
         <a href="/order">Order</a>
         <a href="/account">Account</a>
      </div>
      <div class="user-info">
        <h1 class="text">Ordering page</h1>
      </div>
      {% with messages = get_flashed_messages() %}
      {% if messages %}
          <div class="flash-messages">
              {% for message in messages %}
                  <p class="flash">{{ message }}</p>
              {% endfor %}
          </div>
      {% endif %}
      {% endwith %}

    <div class="tabs">
        <div class="menu">
            <h1>Menu</h1>
            <div class="order-item" id="1" data-name="Chicken rice" data-price="12.50">
                <img src="{{ url_for('static', filename='images/chicken rice.jpg') }}" class="image">
                <div class="order-description">
                    <h2>Chicken rice</h2>
                    <p>A good ol' Hainese chicken rice. Definitely not a scam</p>
                </div>
                
                <h3>Price: $12.50</h3>
            </div>
            <div class="order-item" id="2" data-name="Avocado toast" data-price="7.50">
                <img src="{{ url_for('static', filename='images/avocado toast.jpg') }}" class="image">
                <div class="order-description">
                    <h2>Avocado toast</h2>
                    <p>A fresh avocado with sesame seeds on sourdough bread.</p>
                </div>
                
                <h3>Price: $7.50</h3>
            </div>
              <div class="order-item" id="3" data-name="Chicken Casear salad" data-price="9.90">
                  <img src="{{ url_for('static', filename='images/chicken casear salad.jpg') }}" class="image">
                  <div class="order-description">
                    <h2>Chicken Casear salad</h2>
                    <p>Made with chicken, tomatoes, bread cubes in our savoury sauce!</p>
                  </div>
                  
                  <h3>Price: $9.90</h3>
              </div>
              <div class="order-item" id="4" data-name="Kung Pao Chicken" data-price="12.00">
                  <img src="{{ url_for('static', filename='images/chicken.jpg') }}" class="image">
                  <div class="order-description">
                    <h2>Kung Pao Chicken</h2>
                    <p>Marinated overnight with herbs and spices, Kung Pao chicken is a staple in AWS accelerator!</p>
                  </div>
                  
                  <h3>Price: $12.00</h3>
              </div>
              <div class="order-item" id="5" data-name="Pasta Alfredo" data-price="11.75">
                  <img src="{{ url_for('static', filename='images/pasta.jpg') }}" class="image">
                  <div class="order-description">
                    <h2>Pasta Alfredo</h2>
                    <p>We don't remember being an Italian restaurant, but sure why not I guess</p>
                  </div>
                  
                  <h3>Price: $11.75</h3>
              </div>
              <div class="order-item" id="6" data-name="Plain rice" data-price="1.50">
                  <img src="{{ url_for('static', filename='images/rice.jpg') }}" class="image">
                  <div class="order-description">
                    <h2>Plain rice</h2>
                    <p>You came to a 5 star restaurant and you decide to order plain rice? lmao</p>
                  </div>
                  
                  <h3>Price: $1.50</h3>
              </div>
              <div class="order-item" id="7" data-name="Chicken skewers" data-price="7.99">
                <img src="{{ url_for('static', filename='images/chicken-skewers.jpg') }}" class="image">
                <div class="order-description">
                    <h2>Chicken skewers</h2>
                    <p>Grilled to perfection over applewood, low and slow. (definitely not a MaxtheMeatGuy reference)</p>
                </div>
                
                <h3>Price: $7.99</h3>
            </div>
            <div class="order-item" id="8" data-name="Beef meatballs in marinara sauce" data-price="6.49">
                <img src="{{ url_for('static', filename='images/meatballs.jpg') }}" class="image">
                <div class="order-description">
                    <h2>Beef meatballs in marinara sauce</h2>
                    <p>Juicy and succulent meatballs in our famous signature sauce</p>
                </div>
                <h3>Price: $6.49</h3>
            </div>
            <div class="order-item" id="9" data-name="Stir fried vegetables" data-price="6.49">
                <img src="{{ url_for('static', filename='images/vegetable.jpg') }}" class="image">
                <div class="order-description">
                    <h2>Stir fried vegetables</h2>
                    <p>Touch grass now</p>
                </div>
                
                <h3>Price: $6.49</h3>
            </div>
            <div class="order-item" id="10" data-name="Samuel's specialty" data-price="69.00">
                <img src="{{ url_for('static', filename='images/most-delicious.jpg') }}" class="image">
                <div class="order-description">
                    <h2>Samuel's specialty</h2>
                    <p>The best meal ever, it is the reason why our restaurant is the most famous, it is a must to have it</p>
                </div>      
                    <h3>Price: $1000
                </h3>
            </div>
            <div class="order-item" id="11" data-name="buffet" data-price="25.00">
                <img src="{{ url_for('static', filename='images/buffet.jpg') }}" class="image">
                <div class="order-description">
                    <h2>Buffet 2 hours</h2>
                    <p>Buffet all you can eat for 2 hours, serves one customer only</p>
                </div>      
                    <h3>Price: $25
                </h3>
            </div>
            <div class="order-item" id="12" data-name="Coke" data-price="1.50">
                <img src="{{ url_for('static', filename='images/coke.jpg') }}" class="image">
                <div class="order-description">
                    <h2>Coke</h2>
                    <p>Coco-cola</p>
                </div>      
                    <h3>Price: $1.50
                </h3>
            </div>
            <div class="order-item" id="13" data-name="Pepsi" data-price="1.50">
                <img src="{{ url_for('static', filename='images/pepsi.jpg') }}" class="image">
                <div class="order-description">
                    <h2>Pepsi</h2>
                    <p>Alternative Coco-cola :)</p>
                </div>      
                    <h3>Price: $1.50
                </h3>
            </div>
            <div class="order-item" id="14" data-name="Water" data-price="1.0">
                <img src="{{ url_for('static', filename='images/water.jpg') }}" class="image">
                <div class="order-description">
                    <h2>Water</h2>
                    <p>Toilet version available for purchase as well, please request from our staff</p>
                </div>      
                    <h3>Price: $1.0
                </h3>
            </div>
            <div class="order-item" id="15" data-name="Wine" data-price="5.0">
                <img src="{{ url_for('static', filename='images/wine.jpg') }}" class="image">
                <div class="order-description">
                    <h2>Wine</h2>
                    <p>Fine wine</p>
                </div>      
                    <h3>Price: $5.0
                </h3>
            </div>



        </div>
        <div class="ordering">

            <h1>Order list</h1>
            <div id="order-list"></div>

            <div id="total-bill">
                <h3>Total: $<span id="total-amount">0.00</span></h3>
            </div>

            <div class="form-container">
                <form id="order-form" method="POST" action="{{ url_for('submit_order') }}" class="form">

                    <select name="location" id="dining-location" class="large-select" required>
                        <option value="" disabled selected>Select your location</option>
                        <option value="Bugis Junction">Bugis Junction</option>
                        <option value="Marina Square">Marina Square</option>
                        <option value="Tampines Mall">Tampines Mall</option>
                        <option value="Northpoint City">Northpoint City</option>
                    </select><br>
                    <input type=number min=1  placeholder="Number of Pax"class="large-select" required></input>
                    
                    <!-- Move the order list inside the form -->
                    <div id="order-list"></div>

                    <button type="submit" class="submit-button">Send order</button>
                </form>
            </div>


        </div>
    </div>

    <script>
document.addEventListener('DOMContentLoaded', function() {
    const orderItems = document.querySelectorAll('.order-item');
    const orderForm = document.getElementById('order-form');
    const totalAmountElem = document.getElementById('total-amount'); // To display total
    let totalAmount = 0; // Initialize total amount

    orderItems.forEach(item => {
        item.addEventListener('click', function() {
            const name = item.getAttribute('data-name');
            const price = parseFloat(item.getAttribute('data-price')); // Get price as number

            // Create a container for the ordered item to display in the form
            const orderListItem = document.createElement('div');
            orderListItem.classList.add('ordered-item');
            orderListItem.innerHTML = `
                <div>
                    <h3>${name}</h3>
                    <h3>Price: $${price.toFixed(2)}</h3>
                </div>
                <div class="delete_button"></div>
            `;

            // Create a hidden input for the order item and append it to the form directly
            const hiddenInput = document.createElement('input');
            hiddenInput.type = 'hidden';
            hiddenInput.name = 'order_item';
            hiddenInput.value = `${name} - $${price.toFixed(2)}`;
            orderForm.appendChild(hiddenInput);

            // Add delete button functionality
            const deleteButton = orderListItem.querySelector('.delete_button');
            deleteButton.addEventListener('click', function(event) {
                event.stopPropagation();
                orderListItem.remove(); // Remove the displayed item
                hiddenInput.remove();   // Remove the corresponding hidden input

                // Recalculate the total
                totalAmount -= price;
                totalAmountElem.textContent = totalAmount.toFixed(2);
            });

            // Append the order list item to a visible area (not the form) for user view
            const orderList = document.getElementById('order-list');
            orderList.appendChild(orderListItem);

            // Update total amount
            totalAmount += price;
            totalAmountElem.textContent = totalAmount.toFixed(2);
        });
    });
});



    </script>

   </body>
</html>

